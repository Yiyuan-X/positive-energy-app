{"version":3,"file":"static/js/923.327b4033.chunk.js","mappings":"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","sources":["admin/LoveFeelingCodeAdmin.jsx","pages/AdminDashboard.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport \"./LoveCodeAdmin.css\"; // âœ… å¯å¤ç”¨åŒæ ·æ ·å¼\n\nexport default function LoveFeelingCodeAdmin() {\n  const [codes, setCodes] = useState([]);\n  const [filter, setFilter] = useState(\"all\");\n  const [loading, setLoading] = useState(false);\n  const [newCount, setNewCount] = useState(10);\n  const [message, setMessage] = useState(\"\");\n\n  async function loadCodes() {\n    try {\n      setLoading(true);\n      let query = supabase\n        .from(\"love_feeling_access_codes\")\n        .select(\"*\")\n        .order(\"created_at\", { ascending: false });\n\n      if (filter === \"unused\") query = query.eq(\"is_used\", false);\n      if (filter === \"used\") query = query.eq(\"is_used\", true);\n\n      const { data, error } = await query;\n\n      if (error) {\n        console.error(\"âŒ Supabase æŸ¥è¯¢å¤±è´¥:\", error.message);\n        setMessage(\"âš ï¸ æƒé™ä¸è¶³æˆ–åŠ è½½å¤±è´¥ï¼š\" + error.message);\n        setCodes([]);\n      } else {\n        setCodes(data || []);\n      }\n    } catch (err) {\n      console.error(\"ğŸ’¥ å¼‚å¸¸:\", err);\n      setMessage(\"ğŸ’¥ åŠ è½½å‡ºé”™ï¼š\" + err.message);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    loadCodes();\n  }, [filter]);\n\n  async function generateCodes() {\n    try {\n      setLoading(true);\n      const { data, error } = await supabase.functions.invoke(\"generate-love-feeling-codes\", {\n        body: JSON.stringify({ count: newCount }),\n      });\n\n      if (error) {\n        console.error(\"âŒ ç”Ÿæˆå¤±è´¥:\", error.message);\n        setMessage(\"âŒ ç”Ÿæˆå¤±è´¥ï¼š\" + error.message);\n      } else {\n        setMessage(`âœ… å·²ç”Ÿæˆ ${newCount} ä¸ªå–œæ¬¢æµ‹è¯•å…‘æ¢ç `);\n        await loadCodes();\n      }\n    } catch (err) {\n      console.error(\"ğŸ’¥ è°ƒç”¨å‡½æ•°å¤±è´¥:\", err);\n      setMessage(\"ğŸ’¥ ç½‘ç»œæˆ–å‡½æ•°é”™è¯¯ï¼š\" + err.message);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  function exportCSV() {\n    const csv = [\n      [\"code\", \"price\", \"discount_price\", \"is_used\", \"used_at\"].join(\",\"),\n      ...codes.map((c) =>\n        [c.code, c.price, c.discount_price, c.is_used, c.used_at || \"\"].join(\",\")\n      ),\n    ].join(\"\\n\");\n\n    const blob = new Blob([csv], { type: \"text/csv\" });\n    const link = document.createElement(\"a\");\n    link.href = URL.createObjectURL(blob);\n    link.download = \"love_feeling_access_codes.csv\";\n    link.click();\n  }\n\n  return (\n    <div className=\"love-admin\">\n      <h2>ğŸ’ å–œæ¬¢æµ‹è¯•å…‘æ¢ç ç®¡ç†</h2>\n\n      <div className=\"actions\">\n        <select value={filter} onChange={(e) => setFilter(e.target.value)}>\n          <option value=\"all\">å…¨éƒ¨</option>\n          <option value=\"unused\">æœªä½¿ç”¨</option>\n          <option value=\"used\">å·²ä½¿ç”¨</option>\n        </select>\n\n        <input\n          type=\"number\"\n          min=\"1\"\n          max=\"100\"\n          value={newCount}\n          onChange={(e) => setNewCount(Number(e.target.value))}\n        />\n        <button onClick={generateCodes} disabled={loading}>\n          âš¡ ç”Ÿæˆå…‘æ¢ç \n        </button>\n        <button onClick={exportCSV}>ğŸ“¤ å¯¼å‡º CSV</button>\n      </div>\n\n      {message && <p className=\"message\">{message}</p>}\n      {loading && <p>åŠ è½½ä¸­...</p>}\n\n      {!loading && codes.length > 0 && (\n        <table className=\"code-table\">\n          <thead>\n            <tr>\n              <th>å…‘æ¢ç </th>\n              <th>åŸä»·</th>\n              <th>ä¼˜æƒ ä»·</th>\n              <th>çŠ¶æ€</th>\n              <th>ä½¿ç”¨æ—¶é—´</th>\n            </tr>\n          </thead>\n          <tbody>\n            {codes.map((c) => (\n              <tr key={c.code} className={c.is_used ? \"used\" : \"unused\"}>\n                <td>{c.code}</td>\n                <td>{c.price}</td>\n                <td>{c.discount_price}</td>\n                <td>{c.is_used ? \"âœ… å·²ç”¨\" : \"ğŸ•“ æœªç”¨\"}</td>\n                <td>{c.used_at ? new Date(c.used_at).toLocaleString() : \"-\"}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      )}\n    </div>\n  );\n}\n","import { useState, useEffect, lazy, Suspense } from \"react\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport LoveFeelingCodeAdmin from \"../admin/LoveFeelingCodeAdmin\"; // ğŸ’ æ–°å¢å–œæ¬¢æµ‹è¯•å…‘æ¢ç ç®¡ç†é¡µ\n\n// åŸæœ‰æ¨¡å—å»¶è¿ŸåŠ è½½\nconst LoveCodeAdmin = lazy(() => import(\"../admin/LoveCodeAdmin\"));\nconst LoveOrdersAdmin = lazy(() => import(\"../admin/LoveOrdersAdmin\"));\n\nexport default function AdminDashboard() {\n  const [user, setUser] = useState(null);\n  const [tab, setTab] = useState(\"codes\");\n\n  // âœ… æ£€æŸ¥ç™»å½•ä¸ç®¡ç†å‘˜æƒé™\n  useEffect(() => {\n    (async () => {\n      const { data } = await supabase.auth.getUser();\n\n      if (!data?.user) {\n        alert(\"è¯·å…ˆç™»å½•\");\n        window.location.href = \"/\";\n        return;\n      }\n\n      // æŸ¥è¯¢ç”¨æˆ·è§’è‰²\n      const { data: profile, error } = await supabase\n        .from(\"profiles\")\n        .select(\"role\")\n        .eq(\"id\", data.user.id)\n        .maybeSingle();\n\n      if (error) {\n        console.error(\"âŒ è·å–ç”¨æˆ·è§’è‰²å¤±è´¥ï¼š\", error.message);\n      }\n\n      if (profile?.role !== \"admin\") {\n        alert(\"âŒ æ‚¨æ²¡æœ‰è®¿é—®åå°çš„æƒé™\");\n        window.location.href = \"/\";\n        return;\n      }\n\n      setUser(data.user);\n    })();\n  }, []);\n\n  if (!user) return <p style={{ textAlign: \"center\" }}>æ­£åœ¨éªŒè¯æƒé™...</p>;\n\n  // âœ… é¡µé¢ä¸»ä½“\n  return (\n    <div className=\"admin-dashboard\">\n      <h2>ğŸ’¼ ç®¡ç†åå°</h2>\n\n      {/* -----------------------------\n      ğŸ§­ åå°å¯¼èˆªæ ‡ç­¾\n      ------------------------------ */}\n      <div className=\"tabs\">\n        <button\n          className={tab === \"codes\" ? \"active\" : \"\"}\n          onClick={() => setTab(\"codes\")}\n        >\n          ğŸ å æœ‰æ¬²æµ‹è¯•å…‘æ¢ç \n        </button>\n\n        <button\n          className={tab === \"loveFeelingCodes\" ? \"active\" : \"\"}\n          onClick={() => setTab(\"loveFeelingCodes\")}\n        >\n          ğŸ’ å–œæ¬¢æµ‹è¯•å…‘æ¢ç \n        </button>\n\n        <button\n          className={tab === \"orders\" ? \"active\" : \"\"}\n          onClick={() => setTab(\"orders\")}\n        >\n          ğŸ“¦ è®¢å•ç®¡ç†\n        </button>\n      </div>\n\n      {/* -----------------------------\n      ğŸ§© å†…å®¹åŒºï¼ˆæ‡’åŠ è½½ç»„ä»¶ï¼‰\n      ------------------------------ */}\n      <Suspense fallback={<p style={{ textAlign: \"center\" }}>åŠ è½½ä¸­...</p>}>\n        {tab === \"codes\" && <LoveCodeAdmin />}\n        {tab === \"loveFeelingCodes\" && <LoveFeelingCodeAdmin />}\n        {tab === \"orders\" && <LoveOrdersAdmin />}\n      </Suspense>\n    </div>\n  );\n}\n"],"names":["LoveFeelingCodeAdmin","codes","setCodes","useState","filter","setFilter","loading","setLoading","newCount","setNewCount","message","setMessage","async","loadCodes","query","supabase","from","select","order","ascending","eq","data","error","console","err","useEffect","_jsxs","className","children","_jsx","value","onChange","e","target","type","min","max","Number","onClick","functions","invoke","body","JSON","stringify","count","concat","disabled","csv","join","map","c","code","price","discount_price","is_used","used_at","blob","Blob","link","document","createElement","href","URL","createObjectURL","download","click","length","Date","toLocaleString","LoveCodeAdmin","lazy","LoveOrdersAdmin","AdminDashboard","user","setUser","tab","setTab","auth","getUser","alert","window","location","profile","id","maybeSingle","role","Suspense","fallback","style","textAlign"],"sourceRoot":""}